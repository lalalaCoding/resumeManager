<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>아이디 찾기</title>
	<title>Resume History - 로그인</title>
	<!-- 페이지명 왼쪽에 아이콘 삽입 -->
	<link rel="shortcut icon" href="image/icon/logo.png">
	<!-- 외부 스타일 시트 연결 -->
	<link href="css/find.css?after" rel="stylesheet" type="text/css"/>
	<!-- jQuery CDN -->
	<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
</head>
<body>
	<div th:replace="~{common/header :: header}"></div>
	
	<div id="wrapper">
		<div><!-- 왼쪽 공백 --></div>
		<div>
			<h1 th:text="${session.find == 'id' ? '아이디 찾기' : '비밀번호 찾기'}"></h1>
			<div>
				<form method="post" action="find.me" id="findForm">
					<table>
						<tr>
							<td th:text="${session.find == 'id' ? '이름' : '아이디'}"></td>
							<td>
								<input type="text" th:name="${session.find == 'id' ? 'memberName' : 'memberId'}" class="form-control" th:placeholder="${session.find == 'id' ? '이름을 입력해주세요' : '아이디를 입력해주세요'}"/>
							</td>
						</tr>
						<tr>
							<td>휴대전화 번호</td>
							<td>
								<input type="number" class="form-control phoneNumber" min="0"/>
								-
								<input type="number" class="form-control phoneNumber" min="0"/>
								-
								<input type="number" class="form-control phoneNumber" min="0"/>
								<button type="button" id="phoneCheck" class="btn btn-primary">인증하기</button>
								<input type="hidden" name="memberPhone"/>
							</td>
						</tr>
						<tr>
							<td>휴대전화 인증</td>
							<td>
								<input type="text" class="form-control phoneConfirm" disabled/>
								<button type="button" class="btn btn-primary phoneConfirm" disabled>인증확인</button>
								<span class="badge rounded-pill text-bg-light phoneConfirm">문자 인증이 필요합니다.</span>
							</td>
						</tr>
						<tr>
							<td>
								<button type="button" class="btn btn-primary" th:text="${session.find == 'id' ? '아이디 찾기' : '비밀번호 찾기'}"></button>
							</td>
						</tr>
					</table>
				</form>
			</div>
			
			<br/><br/>
			
			<div>
				<nav style="--bs-breadcrumb-divider: '|';" aria-label="breadcrumb">
					<ol class="breadcrumb">
				    	<li class="breadcrumb-item"><a href="#">아이디 찾기</a></li>
				    	<li class="breadcrumb-item"><a href="#">비밀번호 찾기</a></li>
				    	<li class="breadcrumb-item"><a href="enrollPage.me">회원 가입</a></li>
				  	</ol>
				</nav>
			</div>
			
			<br/><br/>
			
			<div>
				간편 로그인
				<br/>
				<nav style="--bs-breadcrumb-divider: '|';" aria-label="breadcrumb">
					<ol class="breadcrumb">
				    	<li class="breadcrumb-item"><a href="#">카카오</a></li>
				    	<li class="breadcrumb-item"><a href="#">네이버</a></li>
				    	<li class="breadcrumb-item"><a href="#">구글</a></li>
				  	</ol>
				</nav>
			</div>
		</div>
		<div><!-- 오른쪽 공백 --></div>
	</div>
	
	<div th:replace="~{common/footer :: footer}"></div>

	<script th:inline="javascript">
		window.onload = () => {
			/*<![CDATA[*/
			const find = /*[[${session.find}]]*/'find';
			/*]]>*/
			
			const phoneCheck = document.querySelector('#phoneCheck'); // 본인 인증하기 버튼
			const phoneNumbers = document.querySelectorAll('.phoneNumber'); // 휴대전화 번호 입력 요소'들'
			const memberPhone = document.getElementsByName('memberPhone')[0]; // 완성된 휴대전화 번호를 저장할 요소
			
			if(find == 'id'){
				const memberName = document.getElementsByName('memberName')[0]; // 이름 입력 요소
				
				let inputName = '';
				let inputPhone = '';
				
				// 본인 인증 요청 (시작) : 1) 이름과 휴대전화번호가 일치하는가? 2) 인증번호 발송 후 인증번호 입력이 제대로 이루어졌는가?
				phoneCheck.addEventListener('click', () => {
					console.log('본인 인증 요청 시작');
					
					inputName = memberName.value.trim();
					for(const p of phoneNumbers){
						inputPhone += p.value.trim();
					}
					
					// 유효성 검사
					// 이름과 휴대전화 번호가 일치하는지를 검사
					if(inputName.length > 0 && inputPhone.length > 0){
						$.ajax({
							url : 'check-name-phone.me',
							type : 'post',
							data : {memberName : inputName, memberPhone : inputPhone},
							success : data => {
								console.log('일치한다.');
							},
							error : data => {
								console.log('불일치한다.');
							}
						});
											
					} else if(inputName.length == 0){
						
						alert('이름을 입력해주세요.');
					}
				});
				
			}
			
			
			
			
			
			
			
			// 본인 인증 요청 (끝) : 1) 세션에 저장된 find 속성을 제거 2) 결과 페이지로 이동
			
		}
	</script>
</body>
</html>